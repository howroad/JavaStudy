function doSubmit(obj){
	// 提交按钮,提交融资申请
	var checkNum=getCheckNum();
	if (checkNum == 0) {
		alert("至少选择一条记录！");
		return;
	}
	smartForm_doSave(obj);
}

//获取选中的行
function getCheckNum(){
	var checkObj = $("[id$=._check]:visible");
	var checkNum = 0;
	for ( var i = 0; i < checkObj.length; i++) {
		if (checkObj[i].checked) {
			checkNum++;
		}
	}
	return checkNum;
}

// 全选
function checkAll(obj){
	smartForm_all_checkbox(obj,'gdt_guaChangeWait_list._check');
	getCheckSize();
}

// 选择某一个
function checkRec(obj){
	nstc.sf.clickCheckbox(obj);
	getCheckSize();
}

function getCheckSize(){
	var selectRecords = $("[id$=selectRecords]").val();
	var checkNum=getCheckNum();
	var selectRecordsHtml  = '<input id="selectRecords" name="selectRecords" type="hidden" value="'+selectRecords+'"/>'
	$("[id$=selectRecords]").parent().html("共计"+selectRecords+"笔，已选"+checkNum+"笔。"+selectRecordsHtml);
}


//查看
function doLookGua(obj){
	showInput(obj, "v");
}

//修改
function doUpdateGua(obj){
	showInput(obj, "e");
}

function showInput(obj,m){
	var tr = nstc.sf.findParent(obj, "TR");
	var url = 'GDEBIT@gdt_guaChangeInput.sf?m='+m;

	var fmId = $(tr).find("input[id$='.fmId']").val();
	var pledgeId = $(tr).find("input[id$='.pledgeId']").val();
	var occupyId = $(tr).find("input[id$='.occupyId']").val()
	var guaranteeType = $(tr).find("input[id$='.guaranteeType']").val();
	
	url = url +"&fmId="+fmId+"&occupyId="+occupyId+"&pledgeId="+pledgeId+"&guaranteeType="+guaranteeType;
	openwin(url, m=='v'?'担保占用变更详情':'担保占用变更录入', 1200, 600);
}
//删除按钮, 删除融资申请
function doDelete(obj){
	var checkNum = getCheckNum();
	if (checkNum == 0) {
		alert("至少选择一条记录！");
		return;
	}
	if(confirm("确认删除？")){
		smartForm_doSave(obj);
	}
}


//查询操作
function doQuery(obj){
	var sFmDate = $('input[id$="minDate"]').val();
	var eFmDate = $('input[id$="maxDate"]').val();
	if(!compareDate(sFmDate,eFmDate,'变更日期范围不合理')){
		return;
	}
	smartForm_doRefresh(obj)
}
     

//点击确定操作
function smartForm_confirm_true(){
	//$("#父窗口元素ID",window.parent.document);
	var objbut = top.Layer.getWin().document.getElementById("gdt_guaChangeWait_qry.refresh");
	objbut.click();
	windowClose();
	return;
} 