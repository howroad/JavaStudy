//间接融资-贷款》票据贴现
$(function(obj){
	/*var bussClass = $("select[id$=.bussClass]").val('CLMS02');*/
	var bussClass = $("select[id$='.bussClass']").attr('value','CLMS02');
	doChange(bussClass[0]);
	//隐藏业务品种和分类,展示值
	/*$("select[id$=.bussVariety]").val("CLMS11");*/
	$("select[id$='.bussVariety']").attr('value',"CLMS11");
	var bussVariety = $("select[id$='.bussVariety']");
	var cltName = $("input[id$='.cltName']").val();
	var apply = $("input[id$='_form.applyId']").val();
	if(apply != undefined && apply != null && apply != ''){
		var clt = $("input[id$='_info.cltName']");
		doHiddenApply(clt);
		doHidden(bussClass,bussVariety);
		$("input[id$='_info.assBankName']").attr("disabled", true);
		var channel = $("input[id$='_info.contractChannel']").val();
		if(channel && channel == 1){
			$("input[id$='_bill.sel']").attr("disabled", true);
            $("input[id$='_bill.del']").attr("disabled", true);
            
            var pageCode = $("input[id$='pageCode']").val();
            
            var interestAccDay = $("select[id$='_info.interestAccDay']");
            doHiddenSelect(interestAccDay, "interestAccDay");
            
            var principalMethod = $("select[id$='_info.principalMethod']");
            doHiddenSelect(principalMethod, "principalMethod");
            
            var billStyle = $("select[id$='_info.billStyle']");
            doHiddenSelect(billStyle, "billStyle");
            
            var billChecks = $("input[id$='_bill._check']");
            for(var i = 0; i < billChecks.length; i++){
                billChecks[i].parentNode.innerHTML="";
            }
        }
	}
	
	var m = document.getElementById('m').value;
	if(m=='e' || m == 'v' || m == ''){
		doHidden(bussClass,bussVariety);
	}
	
	var channel = $("input[id$='gdt_conBillDisc_form.channel']").val();
    //当channel字段不为GDEBIT时，将带入的数据置换为不可写
	if(isNotNull(channel) && channel != "GDEBIT"){
		var table = $("#gdt_conBillDisc_info");
		doReadOnly(table);
	}
/*	
	var principalMethod=$("select[id$=.principalMethod]").val();
	if (principalMethod==2){
		$("input[id$=.buyIntrCltName]").hide();
		$("input[id$=.sellIntrScale]").val(100).attr('readonly','readonly');
	}else if (principalMethod==1){
		$("input[id$=.buyIntrCltName]").show();
		$("input[id$=.sellIntrScale]").val(0).attr('readonly','readonly');
	}else if(principalMethod==3){
		$("input[id$=.buyIntrCltName]").show();
		$("input[id$=.sellIntrScale]").removeAttr('readonly');
	}
	calSellIntrAmount();
	if(amount!=null&&amount!=""){
		var sellIntrScale =$("input[id$=.sellIntrScale]").val();
		var sellIntrAmount= sellIntrScale
		//$("[id$=.sellIntrAmount]").
	}
	var sellIntrScale =  $("[id$='_info.sellIntrScale']").val();
	 var sellIntrScaleStr = sellIntrScale == 0 ? '0.00' : FormatMoney(sellIntrScale,2);
	    $("[id$='_info.sellIntrScale']").val(sellIntrScaleStr);*/
});

//校验卖方付息比例
/*function checkSellIntrScale(){
    var sellIntrScale =  $("[id$='_info.sellIntrScale']").val();
    var principalMethod =  $("select[id$='_info.principalMethod']").val();
    var regEn = /[`~!@#$%^&*()_+<>?:"{},.\/;'[\]]/im;
    var regCn = /[・！#￥（――）：；“”‘、，|《。》？、【】[\]]/im;

    if(regEn.test(sellIntrScale) || regCn.test(sellIntrScale)) {
    	$("[id$='_info.sellIntrScale']").val("");
    	$("[id$='_info.endDateShow']").val("");
    	$("[id$='_info.endDate']").val("");
    	return false ;
    }
    if(sellIntrScale=='0'&&principalMethod!='1'){
    	alert("卖方付息比例必须大于0！");
    	$("[id$='_info.sellIntrScale']").val("");
    	$("[id$='_info.endDateShow']").val("");
    	$("[id$='_info.endDate']").val("");
    	return false;
    }
    if(sellIntrScale>100){
    	alert("卖方付息比例必须不大于100%！");
    	$("[id$='_info.sellIntrScale']").val("");
    	$("[id$='_info.endDateShow']").val("");
    	$("[id$='_info.endDate']").val("");
    	return false;
    }
    var sellIntrScaleStr = sellIntrScale == 0 ? '0.00' : FormatMoney(sellIntrScale,2);
    $("[id$='_info.sellIntrScale']").val(sellIntrScaleStr);
    return true;
}*/
//录入保存按钮
function doEntrySave(obj){
	
    $("[id$=.isApprove]").val("0");
    if(validDiscDate()){
        smartForm_doSave(obj);
    }
}
//录入提交按钮
function doEntrySubmit(obj){
    $("[id$=.isApprove]").val("1");
    if(validDiscDate()){
        smartForm_doSave(obj);
    }
}
function validDiscDate(){
	var discData = $("input[id$='_info.startDate']").val();
	var disSDateArray = $("input[id$='_bill.startDate']");
    for(var i = 0; i < disSDateArray.length; i++){
        var startDate = disSDateArray[i].value;
        if(DateCompare(discData, startDate) > 0){
            alert("贴现日期不能早于任一出票日期！")
            return false;
        }
    }
    return true;
}
