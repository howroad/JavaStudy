/**
 * 提款申请js
 */
$(function (){
	var list=$('table[id="gdt_withdrawalsApply_list"]');
	var trs=list.find('tbody tr:visible');
	for(var i=0;i<trs.length;i++){
		var umFormState = $(trs[i]).find('input[id$="umFormState"]').val();
		var rejectReason = $(trs[i]).find('input[id$="rejectReaon"]').val();
		if(umFormState==3 || rejectReason != ''){
			$(trs[i]).css("background-color", "#FFC0CB");
		}
	}
});
function onclickAdd(){
	var url = "GDEBIT@gdt_addGdebitFetchApply.sf?m=e";
	openwin(url, '提款申请录入', 1200,1000);
}
function sumbit(obj){
	//处理单选转换选择
	/*if(!hasChecked()){
		return;
	}*/
	var checkList = $("input[id$=._chk]:checked");
	if(checkList.length == 0){
		alert("至少选择一条记录！")
		return;
	}
	smartForm_doSubmit(obj);
}
function deleteRecord(obj){
	/*if(!hasChecked()){
		return;
	}*/
	//处理单选转换选择
	var checkList = $("input[id$='._chk']:checked");
	if(checkList.length == 0){
		alert("至少选择一条记录！")
		return;
	}
	smartForm_doDelete(obj);

}
function queryDetail(obj){
	var tr = $(obj).parent().parent("TR");
	var fmId = $(tr).find("input[id$='fmId']").val();
	var url = 'GDEBIT@gdt_addGdebitFetchApply.sf?m=v&fmId='+fmId;
	openwin(url, '提款申请详情', 1200,800);
}
function updateRecord(obj){
	var tr = $(obj).parent().parent("TR");
	var fmId = $(tr).find("input[id$='fmId']").val();
	var url = 'GDEBIT@gdt_addGdebitFetchApply.sf?m=a&fmId='+fmId;
	openwin(url, '提款申请录入', 1200,800);
}
/**
 * 
 * @param list jquery对象
 * @returns {Boolean}
 */

function hasChecked(){
	var table = $("table[id^=divtab]");
	var list_table = table.find("table");
	var chks = list_table.find("tbody").find("input[type=checkbox]:checked");
	var len = chks.length;
	if(len==0){
		alert("请至少选择一条记录！");
		return false;
	}
	return true;
}
function queryBussVares4Plan(obj) {
	queryBussVares(obj, '')
	var bussVariety = $("select[id$='_con.bussVariety'] option");
	if (bussVariety.eq(0).val() == '') {
		bussVariety.eq(0).remove();
	}
}

//查询验证
function validateAll(obj){
	if(validateAmount() && validateDate()){
		smartForm_doRefresh(obj)
	}
}

// 验证提款金额
function validateAmount(){
	var minAmount = $("[id$='.minAmount']").val();
	var maxAmount = $("[id$='.maxAmount']").val();
	if((minAmount!="" && isNaN(minAmount))
		||(maxAmount!="" && isNaN(maxAmount))){
		alert("提款金额请输入正确数字！");
		return false;
	}
	if(minAmount!="" && maxAmount!=""){
		minAmount = parseFloat(minAmount);
		maxAmount = parseFloat(maxAmount);
		if(minAmount > maxAmount){
			alert("提款金额最小值不能大于提款金额最大值！");
			return false;
		}else{
			return true;
		}
	}else{
		return true;	
	}
}

// 验证期望提款日
function validateDate(){
	var minStartDate = $("[id$='.minStartDate']").val();
	var maxStartDate = $("[id$='.maxStartDate']").val();
	if(minStartDate!="" && maxStartDate!=""){
		var min = new Date();
		var max = new Date();
		min.setFullYear(minStartDate.split("-")[0], minStartDate.split("-")[1], minStartDate.split("-")[2]);
		max.setFullYear(maxStartDate.split("-")[0], maxStartDate.split("-")[1], maxStartDate.split("-")[2]);
		if(min > max){
			alert("期望提款日起始日期不能晚于截止日期！");
			return false;
		}else{
			return true;
		}
	}else{
		return true;
	}
}